#!/bin/bash -l

#Compile program
nvcc 3d_cg.cu -o mfa -include cg_descent.c -lcufft -w

#Edit the density here to get corresponding pressures
densCH4=( 2.41545907501283e-10
2.41546031534660e-09
2.41547271877583e-08
2.41559676221907e-07
2.41683811285352e-06
1.21118775161650e-05
3.79112225064805e-05
6.40287979230548e-05
9.04726235198815e-05
0.000117251142678440
0.000144373246187808
0.000171848297217681
0.000199686157526706
0.000227897214942423
0.000256492412140347
0.000311767775821802
0.000368548699506211
0.000426928570965295
0.000487010404270087
0.000548907742496956
0.000612745573223040
0.000678661212882246
0.000746805089146687
0.000817341311039284
0.000890447859627229
0.000966316151958686
0.00139439386394224
0.00191854497525761
0.00251559401413783
0.00308429141545880
0.00354883245777632
0.00390974706346794
0.00419306903206203
0.00442184938876813
0.00461202142648469
0.00477410755928636
0.00491512720277675
0.00503988808317990
0.00515178197988778
0.00525327049158680
0.00534618662111086
0.00543192679789090
0.00551157648757070
0.00558599454031330
0.00565587123396166
0.00572176912148520
0.00578415236971712 )

densCO2=( 2.41545907501283e-10
2.41546031534660e-09
2.41547271877583e-08
2.41559676221907e-07
2.41683811285352e-06
1.21118775161650e-05
3.79112225064805e-05
6.40287979230548e-05
9.04726235198815e-05
0.000117251142678440
0.000144373246187808
0.000171848297217681
0.000199686157526706
0.000227897214942423
0.000256492412140347
0.000311767775821802
0.000368548699506211
0.000426928570965295
0.000487010404270087
0.000548907742496956
0.000612745573223040
0.000678661212882246
0.000746805089146687
0.000817341311039284
0.000890447859627229
0.000966316151958686
0.00139439386394224
0.00191854497525761
0.00251559401413783
0.00308429141545880
0.00354883245777632
0.00390974706346794
0.00419306903206203
0.00442184938876813
0.00461202142648469
0.00477410755928636
0.00491512720277675
0.00503988808317990
0.00515178197988778
0.00525327049158680
0.00534618662111086
0.00543192679789090
0.00551157648757070
0.00558599454031330
0.00565587123396166
0.00572176912148520
0.00578415236971712 )

temperature=313.15
epsilon0=148
sigma0=3.73
epsilon1=236.1
sigma1=3.75



rm comp_output.dat
touch comp_output.dat

i=0
while (($i <= ${#densCH4[*]} - 1))
do
    cp copy.dat input.dat
    
    # if (($i == 0))
    # then
    #     echo "(#)	(bar)		(mol/L)		(mol/L)" >> comp_output.dat
    # fi

    
    sed -i "s/TEMPERATURE/${temperature}/g" input.dat
    sed -i "s/BULKDENS0/${densCH4[$i]}/g" input.dat
    sed -i "s/BULKDENS1/${densCO2[$i]}/g" input.dat
    sed -i "s/EPSILON0/${epsilon0}/g" input.dat
    sed -i "s/EPSILON1/${epsilon1}/g" input.dat
    sed -i "s/SIGMA0/${sigma0}/g" input.dat
    sed -i "s/SIGMA1/${sigma1}/g" input.dat
    
    timeout 4m ./mfa input.dat | tee -a comp_output.dat
    
    i=$((i+1))
done

exit 0;